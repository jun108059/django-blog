# Django ë¸”ë¡œê·¸ project ë§Œë“¤ê¸°-1
  
![img](../.vuepress/public/images/Logo.png)  
  
#### ğŸ§±Preference

> Windows10  
> python 3.7 ì´ìƒ  
> Git Bash  
> MTV ê¸°ë³¸ì ì¸ ê°œë…

---

## 1. Blog í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°

[ì´ì „ Session](https://github.com/Mulgyeol/2020-Django/blob/master/1.md) ì¤‘ë³µ ë‚´ìš©ì…ë‹ˆë‹¤

ê°€ìƒí™˜ê²½ì„ ë§Œë“¤ê³  django pip íŒ¨í‚¤ì§€ ì„¤ì¹˜ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.

ì´ì „ ê°•ì˜ì™€ ë™ì¼í•˜ê²Œ `blogproject`ë¡œ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ë³¼ê²Œìš”.

```bash
$ python -m venv myvenv # ê°€ìƒí™˜ê²½ ìƒì„±

$ source myvenv/scripts/activate # ê°€ìƒí™˜ê²½ ì‹¤í–‰

$ pip install django # django ì„¤ì¹˜

$ django-admin startproject blogproject #í”„ë¡œì íŠ¸ ìƒì„±

# ì´ë•Œ manage.pyê°€ ìœ„ì¹˜í•œ í”„ë¡œì íŠ¸ ì•ˆ(BASE_DIR)ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤.

$ python manage.py startapp 'blog' # app ìƒì„±

$ python manage.py runserver # http://127.0.0.1:8000/
```

> ê°€ìƒí™˜ê²½ì„ ì¢…ë£Œí•˜ë ¤ë©´ `deactivate`ë¥¼ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.

---

## 2. settings.py - blog App ì¶”ê°€

`[ì´ì „ Session](https://github.com/Mulgyeol/2020-Django/blob/master/1.md) ì¤‘ë³µ ë‚´ìš©ì…ë‹ˆë‹¤`

projectë¥¼ ìƒì„±í•˜ê³  appë„ ë§Œë“¤ì—ˆìœ¼ë‹ˆ, `settings.py`ì— appì„ ëª…ì‹œí•´ì¤ë‹ˆë‹¤.

```python
# settings.py
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'blog',
]
```

---

## 3. template ë§Œë“¤ê¸°

ê²½ë¡œ : `blog/templates/blog/home.html`

ì´ë²ˆ ê°•ì˜ì—ì„œëŠ” ë¶€íŠ¸ìŠ¤íŠ¸ë©4ë¥¼ í™œìš©í•´ì„œ `navbar`ë¥¼ ë„£ì–´ë³¼ê²Œìš”.

ì œê°€ ì ìš©í•œ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì…”ë„ ì¢‹ê³  ë‹¤ë¥¸ ë¶€íŠ¸ìŠ¤íŠ¸ë© [navbar](](https://bootsnipp.com/snippets/nNX3a)ë¥¼ ì‚¬ìš©í•˜ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤!

ì €ëŠ” ì˜ˆì œ ì½”ë“œì— ë§ê²Œ ì½”ë“œë¥¼ ì¡°ê¸ˆ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.

```HTML
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{% url 'home' %}">Likelion8th</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav ml-auto">
                    <a class="nav-item nav-link active" href="{% url 'home' %}">Home</span></a>
                    <a class="nav-item nav-link" href="#">Blog</a>
                    <a class="nav-item nav-link" href="#">ë‚´ì •ë³´</a>
                </div>
            </div>
        </div>
    </nav>
```

body íƒœê·¸ ì•ˆì— ë‚´ìš©ì„ ë³µë¶™í•´ì„œ í™•ì¸í•´ë³´ì…”ë„ ì¢‹ì•„ìš”.

ì˜ ì•ˆë˜ë©´ [ì „ì²´ì½”ë“œ](https://gist.github.com/jun108059/32f94be4692125b6bdc5013e9d5c2d12)ë¥¼ ì°¸ê³ í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

---

## 4. view ë§Œë“¤ê¸°

ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ home.html íŒŒì¼ì„ ì—´ì–´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ blog í´ë” ë‚´ë¶€ì— `views.py`íŒŒì¼ì— ì‘ì„±í•´ë´…ì‹œë‹¤.

![img](../.vuepress/public/images/django1/django-06.png)
 
> í•¨ìˆ˜ ì´ë¦„ì€ ë§ˆìŒëŒ€ë¡œ ì •í•˜ì…”ë„ ìƒê´€ ì—†ì–´ìš”!  

----

## 5. URLconf ì—°ê²°

ë‹¤ìŒì€ urlì„ ì—°ê²°í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.

`urls.py` íŒŒì¼ì„ ì—´ì–´ ë‹¤ìŒ ë‚´ìš©ì„ ì¶”ê°€í•˜ì„¸ìš”.

```python
from django.contrib import admin
from django.urls import path
import blog.views

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', blog.views.home, name="home"),
]
```

![img](../.vuepress/public/images/django1/django-07.png)  

![img](../.vuepress/public/images/django1/django-05.png)

> ì¤‘ê°„ í™”ë©´ì€ ì´ë ‡ê²Œ ì¶œë ¥ë©ë‹ˆë‹¤.

---

## 6. models.py ì‘ì„±

[ì´ì „ Session](https://github.com/Mulgyeol/2020-Django/blob/master/1.md) ì¤‘ë³µ ë‚´ìš©ì´ ìˆìŠµë‹ˆë‹¤.

ì´ì „ ìë£Œì—ì„œ ì‚¬ìš©ëë˜ ë°ì´í„°ë¡œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.

- ì œëª©
- ë‚´ìš©
- ì‘ì„±ì¼ì

blog í´ë” ë‚´ì—ì„œ `models.py`ë¥¼ ì—´ì–´

ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•´ ì¤ë‹ˆë‹¤.

```python
from django.db import models

class Post(models.Model):
    title = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')
    body = models.TextField()
```

<details><summary>ì„¤ëª… ë³´ê¸°</summary> 

- `title` : ì œëª©  
- `body` : ë³¸ë¬¸  
- `pub_date` : ì‘ì„±ì¼ì  

1. title ì†ì„±ì€ ìµœëŒ€ lengthê°€ 200ì¸ ë¬¸ìì—´
2. pub_date ì†ì„±ì€ ë‚ ì§œì™€ ì‹œê°„
3. body ì†ì„±ì€ ê¸´ ë¬¸ìì—´

</details>

---

## 7. Database migration

database ëª¨ë¸ì„ ì‘ì„±í•œ ì´í›„ì—ëŠ” í•­ìƒ ë‹¤ìŒ ê³¼ì •ì„ ê±°ì³ì•¼ í•©ë‹ˆë‹¤.

1. `models.py`ì—ì„œ ì½”ë“œ ì‘ì„±
2. `python manage.py makemigrations` ì„ í†µí•´ migration ë§Œë“¤ê¸°
3. `python manage.py migrate` ì„ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ì— ì ìš©í•˜ê¸°

```bash
$ python manage.py makemigrations
$ python manage.py migrate
```

<details><summary>migrationì´ë€?</summary> 

DjangoëŠ” pythonìœ¼ë¡œ ì‘ë™í•˜ëŠ” ì›¹ í”„ë ˆì„ì›Œí¬ì´ì§€ë§Œ DB(ë°ì´í„°ë² ì´ìŠ¤)ì˜ ê²½ìš°ëŠ” ê·¸ë ‡ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ìš°ë¦¬ê°€ ë‚´ë¦° python ì½”ë“œë¥¼ DBê°€ ì•Œì•„ ë“£ê²Œ ì„¤ëª…ì„ í•´ì¤˜ì•¼í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤. ìœ„ì˜ makemigrationsëŠ” ë‚´ê°€ ì§  íŒŒì´ì¬ ì½”ë“œë¥¼ DBê°€ ì•Œì•„ë“¤ì„ìˆ˜ ìˆê²Œ ë²ˆì—­í•˜ëŠ” ëª…ë ¹ì–´ì´ê³ , migrateëŠ” DBì— ê·¸ ë‚´ìš©ì„ ì ìš©í•˜ë¼ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.

</details>

---

## 8. Admin ìƒì„±

ë¸”ë¡œê·¸ ê²Œì‹œê¸€ì„ ê´€ë¦¬í•˜ëŠ” ê´€ë¦¬ì`admin`ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ë´…ì‹œë‹¤.

```bash
$ python manage.py createsuperuser
```

- ì´ë¦„
- ì´ë©”ì¼
- ë¹„ë°€ë²ˆí˜¸ (ì•ˆë³´ì´ëŠ”ê²Œ ì •ìƒ)
- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ (ì•ˆë³´ì´ëŠ”ê²Œ ì •ìƒ)

![img](../.vuepress/public/images/django1/django-02.png)

ì„œë²„ê°€ ì¼œì ¸ìˆëŠ”ì§€ í™•ì¸í•˜ê³ 
`127.0.0.1/admin` ì£¼ì†Œë¡œ ì ‘ì†í•˜ë©´ ë°©ê¸ˆ ì…ë ¥í•œ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¡°ê¸ˆ ìƒì„±í•œ modelì¸ `post`ê°€ ì—†ëŠ” ê´€ë¦¬ì í˜ì´ì§€ê°€ ë³´ì´ì‹¤ê±°ì—ìš”.

djangoì—ê²ŒëŠ” ìš°ë¦¬ê°€ modelì„ ë§Œë“¤ì—ˆë‹¤ëŠ” ê²ƒì„ `migrate`ë¥¼ í†µí•´ ì•Œë ¸ì§€ë§Œ, 

adminì—ê²ŒëŠ” ì•Œë ¤ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

---

## 9. Adminì— model ë“±ë¡í•˜ê¸°

blog í´ë” ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ì„œ admin.pyë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.

```python
from django.contrib import admin
from .models import Post

admin.site.register(Post)
```

- `from .models import Post` : ê°™ì€ í´ë”ì— ìœ„ì¹˜í•´ìˆëŠ” modelsë¼ëŠ” íŒŒì¼ì— Postë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
- `admin.site.register` : admin ì‚¬ì´íŠ¸ì— Postë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.

![img](../.vuepress/public/images/django1/django-08.png)

---

## 10. Admin pageì—ì„œ ê²Œì‹œê¸€ ì‘ì„±í•˜ê¸°

ì •ìƒì ìœ¼ë¡œ `Post`ê°€ ëœ¨ëŠ” ê²ƒì„ í™•ì¸í–ˆë‹¤ë©´ Postë¥¼ ì‘ì„±í•˜ê³  ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<details><summary>ì¶”ê°€ëœ Postë¥¼ titleë¡œ ì¸ë±ì‹±í•˜ë ¤ë©´</summary> 
blog í´ë” ì•ˆì˜ models.pyì— `Post` í´ë˜ìŠ¤ë¥¼ ìˆ˜ì •í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

```python
from django.db import models

class Post(models.Model):
    title = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')
    body = models.TextField()
    
    def __str__(self):
        return self.title
```

ë§ˆì§€ë§‰ì— `__str__` ì´ë¼ëŠ” í•¨ìˆ˜ê°€ ì¶”ê°€ëëŠ”ë° ê°„ë‹¨íˆ ìƒê¸´ ê²ƒë§Œ ë³´ë©´ ìê¸° ìì‹ `self`ë¥¼ ë°›ì•„ì„œ `title`ì„ ë°˜í™˜í•´ì£¼ê¸° ë•Œë¬¸ì— ì œëª©ì´ ë³´ì¼ ìˆ˜ ìˆë‹¤ëŠ” ì •ë„ë¡œ ì´í•´í•˜ë©´ ë©ë‹ˆë‹¤!
</details>

---

### Deleteí•˜ê¸°



## 11. viewë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°

modelì„ ë§Œë“¤ê³  ê·¸ ì•ˆì— ë°ì´í„°ë„ ë„£ì—ˆìœ¼ë©´ ì´ê±¸ `template`ìœ¼ë¡œ ë³´ë‚´ ë³´ì—¬ì¤˜ì•¼ í•©ë‹ˆë‹¤.

ê·¸ëŸ°ë° modelì—ì„œ templateìœ¼ë¡œ ë°”ë¡œ ë‚´ìš©ì„ ë³´ë‚¼ìˆ˜ëŠ” ì—†ê³  í•­ìƒ `view`ë¥¼ ê±°ì³ì„œ ë³´ëƒ…ë‹ˆë‹¤.

```python
from django.shortcuts import render
from .models import Post

def home(request):
    posts = Post.objects
    return render(request, 'home.html', {'posts':posts})
```

![img](../.vuepress/public/images/django1/django-09.png)

**âœ”ì½”ë“œ ì‚´í´ë³´ê¸°**  

- `from .models import Post` : views.pyíŒŒì¼ì— Postë¥¼ `import`í•´ì£¼ëŠ” ì‘ì—…  
- `posts = Post.objects` : `Post.objects` ë¼ëŠ” ê²ƒì„ posts ë¼ëŠ” ë³€ìˆ˜ì—ë‹¤ê°€ í• ë‹¹  
- `Post.objects` : ì•„ê¹Œ admin í˜ì´ì§€ì—ì„œ í™•ì¸í–ˆë˜ blog ì•ˆì˜ data  
- `return render(request, 'home.html', {'posts':posts})` : postsë¼ëŠ” ë³€ìˆ˜ë¥¼ templateì—ì„œ ì“¸ë•Œ `posts`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ê°€ì ¸ì˜¤ê² ë‹¤ê³  ëª…ëª…í•˜ëŠ” ì‘ì—…ì…ë‹ˆë‹¤.  

**âœ”posts ë¡œ ë‚´ìš© í™•ì¸**

`navbar` ì•„ë˜ìª½ body ëë‚˜ê¸° ì „ ë¶€ë¶„ì— ì¶”ê°€í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

ëª¨ë¥´ê² ìœ¼ë©´ [í™•ì¸](https://gist.github.com/jun108059/73f2fe3b3299b93db421761561001046)í•˜ê³  ì˜¤ì„¸ìš”!

![img](../.vuepress/public/images/django1/django-10.png)

**âœ”ê²Œì‹œê¸€ ì˜ˆì˜ê²Œ ë„ì›Œì£¼ê¸°**

ì½”ë“œë¥¼ [ë‹¤ìŒê³¼ ê°™ì´](https://gist.github.com/jun108059/2b9ea95da252e92217dd090c3a1d927e) ìˆ˜ì •í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

---

## 12. Detail page ë§Œë“¤ê¸°

ìì„¸í•œ ì„¤ëª…ê³¼ ë°©ë²•ì´ [ì´ì „ Session](https://github.com/Mulgyeol/2020-Django/blob/master/3.md)ì—ì„œ ì˜ ì„¤ëª…ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— **ë¹ ë¥´ê²Œ** ë„˜ì–´ê°€ë´…ì‹œë‹¤.

### template ì¶”ê°€í•˜ê¸°

ê¸¸ì–´ì§€ëŠ” ë³¸ë¬¸ì„ ëª¨ë‘ í‘œì‹œí•˜ì§€ ì•Šê³  ì¼ë¶€ë§Œ ë³´ì—¬ì¤„ ìˆ˜ ìˆê²Œ ì„¤ì •!

`blog/templates/blog` í´ë” ë‚´ë¶€ `detail.html` ìƒì„±

### URLconfig ì¶”ê°€

ì¶”ê°€ë˜ëŠ” ê²Œì‹œê¸€ì— íš¨ê³¼ì ìœ¼ë¡œ ë§¤ì¹­ë  ìˆ˜ ìˆëŠ” URL ì„¤ì •

```python
urlpatterns = [
    path('admin/', admin.site.urls),
    path('', blog.views.home, name="home"),
    path('<int:post_id>/', blog.views.detail, name="detail"),
]
```

`<int:post_id>`ë¼ê³  ì íŒ ë¶€ë¶„ì€ ê° ê²Œì‹œë¬¼ì˜ idê°’ì´ í• ë‹¹

<details><summary>path-converter?</summary>  


ìš°ë¦¬ê°€ ì•„ê¹Œ ì ì–´ì¤¬ë˜ `<int:post_id>`ê°™ì€ ê²ƒë“¤ì„ path-converterë¼ê³  í•©ë‹ˆë‹¤.

ì¥ê³ ì—ì„œ ì—¬ëŸ¬ ê°ì²´ë“¤ì„ ë‹¤ë£¨ëŠ” ê³„ì¸µì  urlì´ í•„ìš”í•  ê²½ìš°ì— ì‚¬ìš©í•˜ë©°, `<type:name>`ì™€ ê°™ì€ ëª¨ì–‘ì…ë‹ˆë‹¤.

'ì§€ì •í•œ converter typeì˜ nameë³€ìˆ˜ë¥¼ view í•¨ìˆ˜ë¡œ ë„˜ê²¨ë¼' í•˜ê³  ì •ë¦¬í•  ìˆ˜ ìˆê² ë„¤ìš”.

converterì˜ ë‹¤ì–‘í•œ íƒ€ì…ì— ëŒ€í•´ ê¶ê¸ˆí•˜ì‹œë©´ êµ¬ê¸€ì— ê²€ìƒ‰í•´ë³´ì‹œëŠ” ê±¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤!
</details>

---

## 13. view ë§Œë“¤ê¸°

templateì„ ì—°ê²°í•´ë´…ì‹œë‹¤.

```python
from django.shortcuts import render, get_object_or_404
from .models import Post

def home(request):
    posts = Post.objects
    return render(request, 'home.html', {'posts':posts})

def detail(request, post_id):
    post_detail = get_object_or_404(Post, pk=post_id)
    return render(request, 'detail.html', {'post':post_detail})
```

ì§€ë‚œ 8ì›” 8ì¼ [ê°•ì˜ìë£Œ](https://github.com/lee-sj/2020-django/blob/master/2020_08_08_handler_sorry.md)ì— ìˆëŠ” `404 handler`ë¥¼ ì²˜ë¦¬í•œ ë¶€ë¶„ì…ë‹ˆë‹¤.

`get_object_or_404` : objectë¥¼ ê°€ì ¸ì˜¤ê³  ì—†ìœ¼ë©´ 404 ì—ëŸ¬ë¥¼ ë„ìš°ë¼ëŠ” ë‚´ìš©ì˜ í•¨ìˆ˜ì…ë‹ˆë‹¤. 

ì•ˆì— `ëª¨ë¸ëª…(ëŒ€ë¬¸ìë¡œ ì‹œì‘)`ê³¼ ë¶ˆëŸ¬ì˜¬ blog ê²Œì‹œê¸€ì˜ idê°’ì„ ì ì–´ ì£¼ë©´ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ê²Œì‹œê¸€ì˜ idê°€ `pk`ê°€ ë©ë‹ˆë‹¤.

`pk`ëŠ” ì—¬ëŸ¬ë¶„ ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ì²˜ëŸ¼ ê³ ìœ í•˜ê²Œ ì¸ì‹ë˜ë©° ì¤‘ë³µë  ìˆ˜ ì—†ëŠ” ê°’ì´ë¼ê³  ì´í•´í•˜ì‹œë©´ ë  ê²ƒ ê°™ì•„ìš”.

ì´ë ‡ê²Œ ë‹´ì€ ë°ì´í„°ë¥¼ `post`ì— ë‹´ì•„ ë„˜ê²¨ì¤ë‹ˆë‹¤.

- ì„ ì–¸í•œ `detail`í•¨ìˆ˜ëŠ” requestì™€ post_idë¥¼ í•¨ê»˜ ë°›ì•„ í•´ë‹¹ ë°ì´í„°ë¥¼ ì „ì†¡
- urls.pyì—ì„œ ë°›ì•„ë‹¬ë¼ê³  ì¸ìë¥¼ ì „ì†¡
- views.py ë°›ì•„ì„œ ì²˜ë¦¬

### ë³´ì—¬ì§ˆ ê¸€ì ìˆ˜ ì§€ì •í•˜ê¸°

blogí´ë”ì˜ `models.py`ì— ì½”ë“œë¥¼ ì¶”ê°€ë¡œ ì‘ì„±í•´ ì£¼ê² ìŠµë‹ˆë‹¤.

```python
from django.db import models

class Post(models.Model):
    title = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')
    body = models.TextField()

    def __str__(self):
        return self.title
# ì•„ë˜ ì½”ë“œ ì¶”ê°€
    def summary(self):
        return self.body[:20]
```

- def summary(self): ë¶€ë¶„ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
- summaryëŠ” bodyì˜ 20ë²ˆì§¸ ê¸€ì ì „ê¹Œì§€ë§Œ ë³´ì—¬ì£¼ê²Œ í•©ë‹ˆë‹¤.

### home.html ìˆ˜ì • & url ì—°ê²°

homeì„ ìˆ˜ì •í•˜ë©´ ê¹”ë”í•´ì§‘ë‹ˆë‹¤.

![img](../.vuepress/public/images/django1/django-11.png)

detailì´ ì˜ ë³´ì…ë‹ˆë‹¤.

![img](../.vuepress/public/images/django1/django-13.png)
![img](../.vuepress/public/images/django1/django-12.png)

## 14. ê²Œì‹œê¸€ ë“±ë¡ í˜ì´ì§€ ë§Œë“¤ê¸°

ëª¨ë“  ì‚¬ìš©ìê°€ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ ë“±ë¡ í˜ì´ì§€ë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.

### template ë§Œë“¤ê¸°

ê²½ë¡œ : `blog/templates/blog/new.html`

ì´ì „ì— ë§Œë“¤ì—ˆë˜ `home.html`íŒŒì¼ì„ ê°€ì ¸ì™€ì„œ navbar ë¶€ë¶„ì„ ì‚´ë¦¬ê³  `ê¸€ì“°ê¸°` íƒ­ì„ ì¶”ê°€í•´ë´…ì‹œë‹¤.

> bootstrap ê´€ë ¨ ë‚´ìš©ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.  

ê¸€ì„ ì‘ì„±í•  ìˆ˜ ìˆëŠ” `form` íƒœê·¸ë¥¼ í™œìš©í•´ ê¸€ì„ ì“¸ ìˆ˜ ìˆë„ë¡ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.

```HTML
<br>
<div class="container">
	<form action="">
	  <h4>ì œëª©: </h4>
	  <input type="text" name="title">
	  <br>
	  <br>
	  <h4>ë³¸ë¬¸: </h4>
	  <textarea cols=40 rows=10 name="body"></textarea>
	  <br>
	  <br>
	  <input class="btn btn-dark" type="submit" value="ì œì¶œí•˜ê¸°">
  </form>
</div>
```

## 15. ì œì¶œí•˜ê¸° ë²„íŠ¼ í™œì„±í™”

ì œì¶œí•˜ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ DBì— ì €ì¥ì´ ë˜ë„ë¡ êµ¬í˜„í•˜ë ¤ê³  í•©ë‹ˆë‹¤.

ê´€ë¦¬ìê°€ postë¥¼ ì¶”ê°€í•œ ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ `home` í™”ë©´ì—ì„œë„ ë³´ì—¬ì§€ë„ë¡ í•´ì•¼í•©ë‹ˆë‹¤.

### template ìˆ˜ì •í•˜ê¸°

ì œì¶œ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ `url`ì„ í†µí•´ ë°ì´í„°ë¥¼ ë„˜ê²¨ë´…ì‹œë‹¤.

```python
<form action="{% url 'create' %}">
```

ì´ actionì— urlì„ ë„˜ê²¨ì£¼ë©´ ë©ë‹ˆë‹¤!

### url ì„¤ì •í•˜ê¸°

```python
path('blog/create/', blog.views.create, name='create'),
```

`path`ë“¤ì„ ì ì–´ ë†“ì€ ê³³ì— ì½”ë“œ í•œ ì¤„ì„ ë” ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.

ì´ì œ ìœ„ì— ì„¤ì •í•´ì¤€ `create` ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ create í•¨ìˆ˜ë¥¼ ë¶€ë¥´ë„ë¡ ì§€ì •ëìŠµë‹ˆë‹¤.

### view ì‘ì„±í•˜ê¸°

`view`ì—ì„œ createí•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.

```python
from django.shortcuts import render, get_object_or_404
from django.utils import timezone

from .models import Post

def home(request):
    posts = Post.objects
    return render(request, 'home.html', {'posts':posts})

def detail(request, post_id):
    post_detail = get_object_or_404(Post, pk=post_id)
    return render(request, 'detail.html', {'post':post_detail})
    
def new(request):
    return render(request, 'post/new.html')

def create(request):
    post = Post()
    post.title = request.GET['title']
    post.body = request.GET['body']
    post.pub_date = timezone.datetime.now()
    post.save()
    return redirect('/blog/' + str(post.id))
```

ì´ë ‡ê²Œ create í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ë©´ DBì— ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


- `request.GET['title']`ì€ new.html íŒŒì¼ì— formíƒœê·¸ ì•ˆì— ìˆëŠ” ë…€ì„ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ í™•ì¸í•´ ë³´ë©´ `name="title"`ì´ë¼ê³  ì í˜€ìˆì„í…ë° ê·¸ë˜ì„œ `GET[]` ì•ˆì— 'title'ì´ ë“¤ì–´ê°€ëŠ” ê²ë‹ˆë‹¤. `blog.body`ë„ ë™ì¼í•œ ë…¼ë¦¬ì…ë‹ˆë‹¤.  
- `blog.pub_date` ì˜ ê²½ìš°ëŠ” ì…ë ¥í•œ ì‹œê°„ì´ ìë™ìœ¼ë¡œ ë„˜ì–´ê°€ê²Œë” ì½”ë“œë¥¼ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. ì´ë•Œ `timezone`ì´ë¼ëŠ” íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•´ì•¼í•´ì„œ ë‘ë²ˆì§¸ ì¤„ì— ë³´ë©´ `import`ë¥¼ í•´ì£¼ëŠ” ê²ë‹ˆë‹¤.  
- `redirect` ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ë³´ì—¬ì£¼ëŠ” í˜ì´ì§€ ì…ë‹ˆë‹¤. `render`ê°€ 'ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì´ html íŒŒì¼ì„ ë³´ì—¬ì¤˜ ë¼ëŠ” ë…€ì„'ì´ì˜€ë‹¤ë©´, `redirect`ëŠ” 'ìš”ì²­ì„ ë“¤ì–´ì˜¤ë©´ ì €ìª½ urlë¡œ ë³´ë‚´ë²„ë ¤' í•˜ëŠ” ë…€ì„ì…ë‹ˆë‹¤.  

---

## 16. ê²Œì‹œê¸€ ì‚­ì œí•˜ê¸°

ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ëŠ” ë¡œì§ë„ ê°„ë‹¨í•©ë‹ˆë‹¤!

ê´€ë¦¬ì`admin` í˜ì´ì§€ì—ì„œ ê²Œì‹œê¸€ ì‚­ì œëŠ” djangoì—ì„œ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ì´ê³  ìš°ë¦¬ê°€ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìœ„ì—ì„œ êµ¬í˜„í–ˆë˜ `more` ë”ë³´ê¸°ë¥¼ ëˆŒë €ì„ ë•Œ ìƒì„¸ í˜ì´ì§€ì¸ `detail`ì´ ëœ¨ëŠ”ë° ì—¬ê¸°ì— ì‚­ì œí•  ìˆ˜ ìˆëŠ” ë§í¬ ì—°ê²°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ ì‰¬ìš¸ê±°ì—ìš”.

ê°„ë‹¨íˆ ë¡œì§ ì½”ë“œë§Œ ì‚´í´ë³´ë©´

`detail.html`

```html
<div class="delete">
	<p><a href="{% url 'delete' post_id %}">ì‚­ì œí•˜ê¸°</a></p>  
</div>
```

ìœ„ì—ì„œ ë§Œë“¤ì–´ì¤€ `delete` ë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ urlì„ ë§Œë“¤ì–´ ì¤˜ì•¼í•©ë‹ˆë‹¤.

í˜„ì¬ `detail` í˜ì´ì§€ì˜ urlì¸ `localhost:8000/<post_id>` ë’¤ì— ì¶”ê°€í•˜ë©´ ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`urls.py`

```python
urlpatterns = [
    path('admin/', admin.site.urls),
    path('', blog.views.home, name="home"),
    path('<int:post_id>/', blog.views.detail, name="detail"),
    path('<int:post_id>/delete', blog.views.detail, name="delete"),
]
```

urls.pyì— ë”°ë¼ ê²½ë¡œë¡œ ì ‘ê·¼ ì‹œ `delete`ë¼ëŠ” í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³ , íŒŒë¼ë¯¸í„°ë¡œ requestë¥¼ ë°›ê³ , detail.htmlì„ í™•ì¸í•´ë³´ë©´ `post_id`ë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤. 

ë°›ì•„ì˜¨ idë¥¼ í†µí•´ ê²Œì‹œê¸€ì´ ì‚­ì œëœ ì´í›„ `redirect`ë¥¼ í†µí•´ `localhost:8000`, homeìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.


`views.py`

```python
def delete(request, post_id):
    post_num = get_object_or_404(Post, pk=post_id)
    post_num.delete()
    return redirect('/')
```

